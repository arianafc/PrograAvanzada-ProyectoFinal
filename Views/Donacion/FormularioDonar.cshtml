@{
    ViewBag.Title = "FormularioDonar";
    Layout = "~/Views/Shared/_Layout.cshtml";

    if (Session["IdUsuario"] == null)
    {
        Response.Redirect("~/Home/IniciarSesion");
    }
}

<main class="container py-5">
    <h1 class="fw-bold text-center mb-4">Apoya con tu Donación</h1>

    <p class="text-center mb-5">
        A través de este formulario puedes contribuir al bienestar de los animales.
        Selecciona la cantidad y método de pago. ¡Gracias por ser parte del cambio!
    </p>

    @if (ViewBag.Error != null)
    {
        <div class="alert alert-danger text-center">
            @ViewBag.Error
        </div>
    }

    <div class="row justify-content-center align-items-center g-4">
        <div class="col-lg-10">
            <div class="card border-0 overflow-hidden">
                <div class="row g-0">
                    <div class="col-md-5 d-none d-md-block bg-white">
                        <div class="h-100 d-flex align-items-center justify-content-center p-3">
                            <img src="~/imagenes/animalesDonar.png" alt="Animales felices" class="img-fluid" style="max-height: 400px;">
                        </div>
                    </div>

                    <div class="col-md-7">
                        <div class="card-body bg-light h-100 d-flex flex-column justify-content-center">
                            <h4 class="fw-bold text-center text-dark mb-4">Formulario de Donación</h4>

                            <form id="formDonar" method="post" action="/Donacion/FormularioDonar">
                                <div class="mb-3">
                                    <label for="cantidad" class="form-label fw-bold">Cantidad a donar</label>
                                    <input type="number" id="cantidad" name="cantidad" class="form-control" placeholder="Digite la cantidad" min="1" required />
                                </div>

                                <div class="mb-3">
                                    <label for="metodo" class="form-label fw-bold">Método de pago</label>
                                    <select id="metodo" name="metodo" class="form-select" required onchange="mostrarModal()">
                                        <option value="">Selecciona un método de pago</option>
                                        <option value="tarjeta">Tarjeta crédito/débito</option>
                                        <option value="sinpe">Sinpe móvil</option>
                                        <option value="paypal">PayPal</option>
                                    </select>
                                </div>
                                <div class="mb-3 d-none" id="grupoReferenciaVisible">
                                    <label for="referenciaVisible" class="form-label fw-bold">Número de referencia ingresado</label>
                                    <input type="text" id="referenciaVisible" class="form-control" readonly />
                                </div>
                                <input type="hidden" id="referenciaOculta" name="referencia" />
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-warning fw-bold text-dark" id="submit-button">Donar</button>
                                </div>
                            </form>

                            <p class="text-center text-muted mt-3 small">
                                <i class="fas fa-heart text-warning"></i> Gracias por tu generosidad
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Modal Tarjeta -->
<div class="modal fade" id="modalTarjeta" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Pago con Tarjeta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formTarjeta">
                    <div class="mb-3">
                        <label for="numeroTarjeta">Número de tarjeta</label>
                        <input type="text" id="numeroTarjeta" class="form-control" placeholder="XXXX-XXXX-XXXX-XXXX" required />
                    </div>
                    <div class="mb-3">
                        <label for="titularTarjeta">Nombre del titular</label>
                        <input type="text" id="titularTarjeta" class="form-control" required />
                    </div>
                    <div class="mb-3">
                        <label for="codigoSeguridad">Código de seguridad</label>
                        <input type="text" id="codigoSeguridad" class="form-control" placeholder="XXX" required />
                    </div>
                    <button type="button" class="btn btn-success" onclick="validarTarjeta()">Finalizar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal Sinpe -->
<div class="modal fade" id="modalSinpe" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Pago por Sinpe Móvil</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Realice su Sinpe al número: <strong>70265643</strong></p>
                <p>Nombre del titular: <strong>Casa Natura</strong></p>
                <div class="mb-3">
                    <label for="referencia" class="form-label fw-bold">Número de referencia Sinpe</label>
                    <input type="text" id="referencia" name="referencia" class="form-control"
                           placeholder="Digite el número de referencia"
                           pattern="^\d{6,30}$"
                           title="Solo números, mínimo 6 dígitos" />
                </div>
                <button type="button" class="btn btn-success" onclick="validarSinpe()">Hecho</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal PayPal -->
<div class="modal fade" id="modalPaypal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Pago con PayPal</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formPaypal">
                    <div class="mb-3">
                        <label for="usuarioPaypal">Usuario de PayPal</label>
                        <input type="text" id="usuarioPaypal" class="form-control" required />
                    </div>
                    <div class="mb-3">
                        <label for="contrasenaPaypal">Contraseña</label>
                        <input type="password" id="contrasenaPaypal" class="form-control" required />
                    </div>
                    <button type="button" class="btn btn-success" onclick="validarPaypal()">Finalizar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="@Url.Content("~/Scripts/apadrinamiento.js")"></script>


